(r=>{r(document).ready(function(){var a,n;function s(){var t;a?a.show():(t=(t=(t=(t=(t='<div class="inspiro-deactivation-modal-overlay">')+'<div class="inspiro-deactivation-modal"><div class="inspiro-deactivation-modal-header">')+"<h2>"+inspiroThemeDeactivateData.labels.title+'</h2><button class="inspiro-deactivation-modal-close">&times;</button>')+'</div><div class="inspiro-deactivation-modal-body">')+'<p class="inspiro-deactivation-intro">Please tell us why you\'re switching themes. Your feedback will help us make Inspiro Lite better for everyone!</p><form id="inspiro-deactivation-form">',inspiroThemeDeactivateData.choices.forEach(function(e){if(t=(t=(t=t+'<div class="inspiro-choice-wrapper">'+'<label class="inspiro-choice-label">')+('<input type="checkbox" name="deactivation_reason" value="'+e.slug+'" /> '))+e.label+"</label>",e.features_options){for(var i in t=t+'<div class="inspiro-features-options" style="margin-top: 12px; padding-left: 25px;">'+'<div style="margin-bottom: 8px; font-size: 13px; color: #111;">Which features? (Select all that apply)</div>',e.features_options)t=(t=t+'<label class="inspiro-feature-label" style="display: block; margin-bottom: 6px; font-size: 13px;"><input type="checkbox" name="missing_features" value="'+i+'" style="margin-right: 8px;" /> ')+e.features_options[i]+"</label>","other-feature"===i&&(t+='<textarea name="choice_missing_features_other_text" class="inspiro-feature-other-text" placeholder="Please specify..." rows="2" style="width: 100%; margin-top: 6px; margin-left: 20px; display: none;"></textarea>');t+="</div>"}else e.text_field&&(t+='<textarea name="'+e.text_field+'" class="inspiro-choice-text" placeholder="Please specify..." rows="2"></textarea>');t+="</div>"}),t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t+="</form></div>")+'<div class="inspiro-deactivation-modal-footer"><div class="inspiro-consent-section">')+'<label class="inspiro-consent-label"><input type="checkbox" id="inspiro-consent-checkbox" checked /> ')+inspiroThemeDeactivateData.labels.consent_checkbox+"</label>")+'</div><div class="inspiro-privacy-notice">')+inspiroThemeDeactivateData.labels.privacy_disclaimer+"</div>")+'<div class="inspiro-modal-buttons"><button class="inspiro-btn inspiro-btn-secondary" id="inspiro-skip-survey">')+inspiroThemeDeactivateData.labels.skip_deactivate)+'</button><button class="inspiro-btn inspiro-btn-primary" id="inspiro-submit-survey">')+inspiroThemeDeactivateData.labels.submit_deactivate+"</button>")+"</div></div>")+"</div></div>",a=r(t),r("body").append(a),a.find(".inspiro-deactivation-modal-close").on("click",function(){i()}),a.find(".inspiro-deactivation-modal-overlay").on("click",function(e){e.target===this&&i()}),a.find('input[name="deactivation_reason"]').on("change",function(){var e=r(this).val(),i=r(this).is(":checked"),t=r(this).closest(".inspiro-choice-wrapper"),a=t.find(".inspiro-choice-text"),t=t.find(".inspiro-features-options");i?(-1===n.choices.indexOf(e)&&n.choices.push(e),a.show(),t.show()):(-1!==(i=n.choices.indexOf(e))&&n.choices.splice(i,1),a.hide().val(""),t.hide(),t.find('input[type="checkbox"]').prop("checked",!1),t.find(".inspiro-feature-other-text").hide().val(""),n.choice_missing_features="",n.choice_missing_features_other_text="")}),a.find('input[name="missing_features"]').on("change",function(){var e=[],i=(a.find('input[name="missing_features"]:checked').each(function(){e.push(r(this).val())}),n.choice_missing_features=e.join(","),"other-feature"===r(this).val()&&r(this).is(":checked")),t=r(this).closest(".inspiro-features-options").find(".inspiro-feature-other-text");i?t.show():"other-feature"===r(this).val()&&(t.hide().val(""),n.choice_missing_features_other_text="")}),a.find(".inspiro-choice-text, .inspiro-feature-other-text").on("input",function(){var e=r(this).attr("name");n[e]=r(this).val()}),a.find("#inspiro-consent-checkbox").on("change",function(){n.user_consent=r(this).is(":checked")}),a.find("#inspiro-skip-survey").on("click",function(){o()}),a.find("#inspiro-submit-survey").on("click",function(){r("#inspiro-submit-survey").prop("disabled",!0).text("Submitting...");var e={choices:n.choices.join(","),choice_technical_issues_text:n.choice_technical_issues_text||"",choice_plugin_compatibility_text:n.choice_plugin_compatibility_text||"",choice_missing_features:n.choice_missing_features||"",choice_missing_features_other_text:n.choice_missing_features_other_text||"",choice_lack_of_support_text:n.choice_lack_of_support_text||"",choice_other_text:n.choice_other_text||"",domain:n.domain,hostname:n.hostname,inspiro_theme_version:n.inspiro_theme_version,wp_version:n.wp_version,language:n.language,php_version:n.php_version,is_multisite:n.is_multisite,active_plugins_count:n.active_plugins_count,timezone_offset:n.timezone_offset,user_agent:n.user_agent,referrer:n.referrer,switching_to_theme:window.inspiroDestinationTheme||"Unknown",user_consent:n.user_consent,usage_duration_seconds:n.usage_duration_seconds,usage_duration_days:n.usage_duration_days,usage_duration_formatted:n.usage_duration_formatted,theme_activated_at:n.theme_activated_at};n.user_consent&&(e.admin_email=n.admin_email),r.ajax({url:inspiroThemeDeactivateData.ajaxUrl,type:"POST",data:{action:"inspiro_theme_deactivation_survey",nonce:inspiroThemeDeactivateData.nonce,...e}});var i,t=new FormData;for(i in e)e.hasOwnProperty(i)&&(Array.isArray(e[i])?t.append(i,JSON.stringify(e[i])):t.append(i,e[i]));r.ajax({url:inspiroThemeDeactivateData.remoteApiUrl,type:"POST",data:t,processData:!1,contentType:!1,timeout:5e3,success:function(e){o()},error:function(e,i,t){o()}})}),a.find(".inspiro-choice-text, .inspiro-features-options").hide())}function i(){a&&(a.remove(),a=null)}function o(){i(),window.inspiroDeactivationHref&&(window.location.href=window.inspiroDeactivationHref)}"undefined"!=typeof inspiroThemeDeactivateData&&(a=null,n={choices:[],domain:inspiroThemeDeactivateData.domain,hostname:inspiroThemeDeactivateData.hostname,inspiro_theme_version:inspiroThemeDeactivateData.inspiroThemeVersion,wp_version:inspiroThemeDeactivateData.wpVersion,language:document.documentElement.getAttribute("lang")||"en-US",php_version:inspiroThemeDeactivateData.phpVersion||"Unknown",is_multisite:inspiroThemeDeactivateData.isMultisite||!1,active_plugins_count:inspiroThemeDeactivateData.activePluginsCount||0,admin_email:inspiroThemeDeactivateData.adminEmail||"",timezone_offset:(new Date).getTimezoneOffset(),user_agent:navigator.userAgent,referrer:document.referrer||"Direct",user_consent:!0,usage_duration_seconds:inspiroThemeDeactivateData.usageData?inspiroThemeDeactivateData.usageData.usage_seconds:0,usage_duration_days:inspiroThemeDeactivateData.usageData?inspiroThemeDeactivateData.usageData.usage_days:0,usage_duration_formatted:inspiroThemeDeactivateData.usageData?inspiroThemeDeactivateData.usageData.formatted:"Unknown",theme_activated_at:inspiroThemeDeactivateData.usageData?inspiroThemeDeactivateData.usageData.activated_at:null},inspiroThemeDeactivateData.choices.forEach(function(e){e.text_field&&(n[e.text_field]=""),e.features_options&&(n.choice_missing_features="",n.choice_missing_features_other_text="")}),r(document).on("click",'.theme-actions .activate, .theme .theme-actions .button-primary, a[href*="action=activate"]',function(e){var i,t,a;i=r(".current-theme .theme-name").text(),t=r(".theme.active .theme-name").text(),a=r("body").attr("class")||"",!(i&&-1!==i.toLowerCase().indexOf("inspiro")||t&&-1!==t.toLowerCase().indexOf("inspiro")||-1!==a.indexOf("inspiro"))||(i=r(this).attr("href"))&&-1!==i.indexOf("action=install")||(t=r(this).closest(".theme").find(".theme-name").text())&&-1!==t.toLowerCase().indexOf("inspiro")||(window.inspiroDestinationTheme=((t=r(a=this).closest(".theme").find(".theme-name, .theme-title").text().trim())||(a=r(a).attr("href"))&&(a=(a=new URLSearchParams(a.split("?")[1])).get("stylesheet")||a.get("template"))&&(t=a.replace(/-/g," ").replace(/\b\w/g,e=>e.toUpperCase())),t||"Unknown Theme"),e.preventDefault(),window.inspiroDeactivationHref=i,s())}),r(document).on("click",'a[href*="action=delete"]',function(e){var i=r(this).attr("href");-1===i.indexOf("stylesheet=inspiro")&&-1===i.indexOf("template=inspiro")||(e.preventDefault(),window.inspiroDeactivationHref=i,s())}))})})(jQuery);